

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Usage &mdash; Crawling Malware 1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Development" href="../pengembangan/ini.html" />
    <link rel="prev" title="Installation" href="../instalasi/ini.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Crawling Malware
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../pendahuluan/ini.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../instalasi/ini.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#dionaea">1. Dionaea</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#menjalanakan-dionaea">1.1 Menjalanakan Dionaea</a></li>
<li class="toctree-l3"><a class="reference internal" href="#memantau-status-koneksi">1.2 Memantau Status Koneksi</a></li>
<li class="toctree-l3"><a class="reference internal" href="#menghentikan-dionaea">1.3 Menghentikan Dionaea</a></li>
<li class="toctree-l3"><a class="reference internal" href="#melihat-komunikasi-penyerang">1.4 Melihat Komunikasi Penyerang</a></li>
<li class="toctree-l3"><a class="reference internal" href="#melihat-log-signature-malware">1.5 Melihat Log Signature Malware</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#cowrie">2. Cowrie</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#menjalankan-cowrie">2.1 Menjalankan Cowrie</a></li>
<li class="toctree-l3"><a class="reference internal" href="#menghentikan-cowrie">2.2 Menghentikan Cowrie</a></li>
<li class="toctree-l3"><a class="reference internal" href="#menjalankan-cowrie-dengan-root">2.3 Menjalankan Cowrie dengan Root</a></li>
<li class="toctree-l3"><a class="reference internal" href="#menjalankan-iptables">2.4 Menjalankan Iptables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#melihat-data-yang-tertangkap">2.5 Melihat Data yang Tertangkap</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../pengembangan/ini.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../remarks/ini.html">Remarks</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Crawling Malware</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Usage</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/penggunaan/ini.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="usage">
<h1>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h1>
<div class="section" id="dionaea">
<h2>1. Dionaea<a class="headerlink" href="#dionaea" title="Permalink to this headline">¶</a></h2>
<div class="section" id="menjalanakan-dionaea">
<h3>1.1 Menjalanakan Dionaea<a class="headerlink" href="#menjalanakan-dionaea" title="Permalink to this headline">¶</a></h3>
<p>Untuk menjalankan dionaea dapat dilakukan dengan terlebih dahulu berpindah pada lokasi file yang dapat menjalankan aplikasi dionaea tersebut. File tersebut bernama dioneaea dimana file tersebut terletak pada direktori /opt/dionaea/bin. Untuk menjalankan dionaea terlebih dahulu menggunakan super user previledge (sudo). Ketika dijalankan dionaea tersebut maka dionaea akan menyediakan layanan yang dibutuhkan oleh setiap malware. Setelah itu akan terdapat banyak malware yang akan menyerang layanan dari dionaea tersebut. Malware tersebut akan terdeteksi dan akan langsung disimpan pada database dionaea. Berikut merupakan detail dari perintah yang digunakan untuk menjalankan dionaea.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$cd /opt/dionaea/bin
$sudo ./dionaea -D
</pre></div>
</div>
<img alt="../_images/35.jpg" src="../_images/35.jpg" />
</div>
<div class="section" id="memantau-status-koneksi">
<h3>1.2 Memantau Status Koneksi<a class="headerlink" href="#memantau-status-koneksi" title="Permalink to this headline">¶</a></h3>
<p>Dionaea memberikan fitur yang dapat digunakan untuk memantau koneksi. Dengan fitur tersebut maka dapat dilihat siapa saja yang mencoba berkomunikasi dengan dionaea saat waktu tersebut. Apabila terdapat seseorang yang membuat koneksi pada dionaea maka akan muncul pada status yaitu “established” yang menandakan bahwa koneksi sudah terbentuk. Jika tidak terdapat yang berkoneksi dengan dionaea maka statusnya yaitu “listen” yang menandakan bahwa dionaea sedang mendengarkan pada port tersebut. Perintah yang digunakan untuk memantau status koneksi sebahai berikut.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$netstat -atn
</pre></div>
</div>
<img alt="../_images/33.jpg" src="../_images/33.jpg" />
</div>
<div class="section" id="menghentikan-dionaea">
<h3>1.3 Menghentikan Dionaea<a class="headerlink" href="#menghentikan-dionaea" title="Permalink to this headline">¶</a></h3>
<p>Apabila data - data malware yang dibutuhkan oleh pengguna sudah cukup maka dapat dilanjutkan dengan tahap menghentikan proses dionea. Ketika proses dihentikan maka layanan yang diberikan oleh dionaea akan berhenti juga dan serangan malware tidak akan terdeteksi. Untuk menghentikan aplikasi dionaea dapat memanfaatkan perintah “pkill”. Sedangkan untuk memastikan apabila dionea sudah tidak berjalan dapat menggunakan command ps aux. Berikut merupakan perintah yang dapat digunakan.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$sudo pkill dionaea
$ps aux | grep dionaea
</pre></div>
</div>
</div>
<div class="section" id="melihat-komunikasi-penyerang">
<h3>1.4 Melihat Komunikasi Penyerang<a class="headerlink" href="#melihat-komunikasi-penyerang" title="Permalink to this headline">¶</a></h3>
<p>Untuk melihat hasil dari serangan yang didapatkan dapat dilihat pada database dari dionea. Database tersebut berisi seluruh data - data serangan dari malware. Database serangan tersebut terletak pada direktori /opt/Dionaea/var/lib/dionaea. Database tersebut terdiri dari beberapa tables. Salah satunya yaitu table koneksi yang memperlihatkan riwayat / catatan serangan yang dilakukan ke malware. Untuk melihat table serangan tersebut dapat digunakan perintah berikut.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$cd /opt/Dionaea/var/lib/dionaea
$sudo sqlite3 dionaea.sqlite
&gt; sqlite&gt; .databases
&gt; sqlite&gt; .tables
&gt; sqlite&gt; SELECT* FROM connections;
</pre></div>
</div>
<img alt="../_images/26.jpg" src="../_images/26.jpg" />
</div>
<div class="section" id="melihat-log-signature-malware">
<h3>1.5 Melihat Log Signature Malware<a class="headerlink" href="#melihat-log-signature-malware" title="Permalink to this headline">¶</a></h3>
<p>Selain melihat komunikasi juga dapat melihat log signature malware yang berhasil tertangkap dionaea. Untuk melihat tabel log signature malware yang tertangkap oleh dionaea dapat melihat pada table log signature. Berikut merupakan perintah yang digunakan untuk menampilkan tabel log signature.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">sqlite</span><span class="o">&gt;</span> <span class="o">.</span><span class="n">tables</span>
<span class="o">&gt;</span> <span class="n">sqlite</span><span class="o">&gt;</span> <span class="n">SELECT</span><span class="o">*</span> <span class="n">FROM</span> <span class="n">downloads</span><span class="p">;</span>
</pre></div>
</div>
<img alt="../_images/28.jpg" src="../_images/28.jpg" />
</div>
</div>
<div class="section" id="cowrie">
<h2>2. Cowrie<a class="headerlink" href="#cowrie" title="Permalink to this headline">¶</a></h2>
<div class="section" id="menjalankan-cowrie">
<h3>2.1 Menjalankan Cowrie<a class="headerlink" href="#menjalankan-cowrie" title="Permalink to this headline">¶</a></h3>
<p>Untuk menjalankan cowrie terlebih dahulu berpindah ke lokasi dimana file bin.cwrie berada. Dalam hal ini, proses menjalankan harus menggunakan user yang telah dibuat yaitu “cowrie”. Apabila sudah berpindah pada lokasi direktori tersebut dapat dilanjutkan dengan menggunakan perintah start sehingga aplikasi cowrie dapat dijalankan. Setelah cowrie dijalankan maka seluruh layanan cowrie akan tersedia bagi para attacker. Attacker akan berusaha memanfaatkan layanan tersebut, sehingga ketika terdapat attacker yang mencoba mengakses cowrie akan tercatat. Detail perintah yang digunakan sebagai berikut.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$cd /home/cowrie/cowrie/
$bin/cowrie start
</pre></div>
</div>
<img alt="../_images/15.jpg" src="../_images/15.jpg" />
</div>
<div class="section" id="menghentikan-cowrie">
<h3>2.2 Menghentikan Cowrie<a class="headerlink" href="#menghentikan-cowrie" title="Permalink to this headline">¶</a></h3>
<p>Jika pengguna sudah cukup memperoleh data - data serangan yang diperlukan maka layanan cowrie bisa dihentikan. Perintah yang digunakan ketika menghentikan juga hampir sama dengan ketika menjalankan cowrie. Hal yang pertama dilakukan yaitu memastikan bahwa lokasi berada pada direktori terdapat file bin/cowrie. Setelah itu menggunakan perintah “stop” untuk menghentikan layanan tersebut. Ketika perintah tersebut dijalankan maka cowrie tidak akan mendeteksi serangan yang terjadi. Berikut merupakan perintah yang digunakan.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$cd /home/cowrie/cowrie/
$bin/cowrie stop
</pre></div>
</div>
</div>
<div class="section" id="menjalankan-cowrie-dengan-root">
<h3>2.3 Menjalankan Cowrie dengan Root<a class="headerlink" href="#menjalankan-cowrie-dengan-root" title="Permalink to this headline">¶</a></h3>
<p>Cowrie juga dapat dijalankan menggunakan root. Hal yang pertama dilakukan yaitu kembali pada shell root. Setelah itu berpindah pada lokasi /etc/systemd/system/ untuk membuat file bernama cowrie-honeypot.se. Apabila sudah didapatkan maka dapat membuat file tersebut dengan teks editor dalam hal ini menggunkan nano. Setelah itu dapat memasukan baris perintah untuk menjalankan layanan cowrie. Berikut merupakan perintah untuk membuat file</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$exit
#nano /etc/systemd/system/cowrie-honeypot.service
</pre></div>
</div>
<p>Berikut perintah yang harus dimasukan pada file cowrie-honeypot.service.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">Unit</span><span class="p">]</span>
<span class="n">Description</span><span class="o">=</span><span class="n">Interactive</span> <span class="n">SSH</span> <span class="n">Honeypot</span>
<span class="n">Wants</span><span class="o">=</span><span class="n">network</span><span class="o">.</span><span class="n">target</span>
<span class="p">[</span><span class="n">Service</span><span class="p">]</span>
<span class="n">Type</span><span class="o">=</span><span class="n">simple</span>
<span class="n">User</span><span class="o">=</span><span class="n">cowrie</span>
<span class="n">Group</span><span class="o">=</span><span class="n">cowrie</span>
<span class="n">ExecStart</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">cowrie</span><span class="o">/</span><span class="n">cowrie</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">cowrie</span> <span class="n">start</span>
<span class="n">Restart</span><span class="o">=</span><span class="n">on</span><span class="o">-</span><span class="n">failure</span>
<span class="n">RestartSec</span><span class="o">=</span><span class="mi">5</span>
<span class="p">[</span><span class="n">Install</span><span class="p">]</span>
<span class="n">WantedBy</span><span class="o">=</span><span class="n">multi</span><span class="o">-</span><span class="n">user</span><span class="o">.</span><span class="n">target</span>
</pre></div>
</div>
<img alt="../_images/17.jpg" src="../_images/17.jpg" />
<p>Untuk menjalankan layanan dari cowrie dapat digunakan perintah sebagai berikut.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#systemctl deaemon-reload</span>
<span class="c1">#systemctl start cowrie-honeyot.service</span>
<span class="c1">#status cowrie-honeypot.service</span>
</pre></div>
</div>
<img alt="../_images/18.jpg" src="../_images/18.jpg" />
</div>
<div class="section" id="menjalankan-iptables">
<h3>2.4 Menjalankan Iptables<a class="headerlink" href="#menjalankan-iptables" title="Permalink to this headline">¶</a></h3>
<p>Iptables pada tahap ini digunakan untuk ketika ada pengguna yang mengakses ssh dari port yang secara default yaitu 22 akan diteruskan secara otomatis ke fake root yang menggunakan port yang telah disetting yaitu port 2222. Hal ini dilakukan supaya mencegah penyerang mendapatkan root sebenarnya dari sistem operasi. Untuk membuat aturan iptables tersebut dapat dilakukan dengan menggunakan command sebagai berikut.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#iptables -A PREROUTING -t nat -p tcp --dport 22 -j REDIRECT --to-port 2222</span>
<span class="c1">#iptables-save &gt; /etc/iptables/rules.v4</span>
</pre></div>
</div>
<img alt="../_images/20.jpg" src="../_images/20.jpg" />
<p>Untuk mengaktifkan IP forwarding dapat dilakukan dengan mengonfigurasi file “/etc/sysctl.conf”. Pastikan untuk menghilangkan tanda (#) pada baris #net.ipv4.ip_forward=1 Atau juga dapat menambahkan baris berikut pada paling bawah baris perintah.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">ipv4</span><span class="o">.</span><span class="n">ip_forward</span><span class="o">=</span><span class="mi">1</span>
</pre></div>
</div>
<img alt="../_images/21.jpg" src="../_images/21.jpg" />
<p>Setelah itu, siapa pun yang mengakses server SSH sebagai root dan menggunakan port 22, secara otomatis akan diteruskan ke port 2222, fake root yang dibuat oleh Cowrie.</p>
</div>
<div class="section" id="melihat-data-yang-tertangkap">
<h3>2.5 Melihat Data yang Tertangkap<a class="headerlink" href="#melihat-data-yang-tertangkap" title="Permalink to this headline">¶</a></h3>
<p>Untuk melihat hasil serangan yang dilakukan terhadap cowrie dapat dilihat dengan melihat log pada cowrie. Log tersebut terletak pada /home/cowrie/cowrie/var/log/cowrie. Log tersebut bernama cowrie.log. Untuk melihat log tersebut dapat digunakan dengan teks editor cowrie. Berikut perintah yang digunakan.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$cd /home/cowrie/cowrie/var/log/cowrie
$cat cowrie.log
</pre></div>
</div>
<img alt="../_images/23.jpg" src="../_images/23.jpg" />
<p>Untuk memudahkan pengembang yang ingin memanfaatkan dari log ini untuk dianalisis lebih lanjut serangan tersebut atau ingin membuat peta serangan tersebut maka tersedia log dengan format json. Berikut merupakan perintah yang digunakan untuk menampilkan format json.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$cd /home/cowrie/cowrie/var/log/cowrie
$cat cowrie.json
</pre></div>
</div>
<img alt="../_images/24.jpg" src="../_images/24.jpg" />
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../pengembangan/ini.html" class="btn btn-neutral float-right" title="Development" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../instalasi/ini.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Kelompok 1 RKSRED

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>